<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Cancer Staging CNN — Demo</title>

  <!-- ลิงก์ CSS (ตัวเดียวพอ) -->
  <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}?v=2" />
  <!-- favicon (มีไฟล์ค่อยใช้ได้) -->
  <link rel="icon" href="{{ url_for('static', filename='favicon.ico') }}" />
</head>

<body>
  <div class="container">
    <div class="nav">
      <div class="brand">Cancer Staging CNN</div>
      <div class="badge">Demo • 3 classes</div>
    </div>

    <div class="card grid two">
      <div>
        <h3>อัปโหลดภาพสไลด์</h3>
        <form action="/predict" method="post" enctype="multipart/form-data">
          <label class="muted">รองรับ .jpg .png</label><br /><br />
          <input type="file" name="file" accept="image/*" required />
          <br /><br />
          <input type="submit" value="Predict" />
        </form>

        {% if disclaimer %}
          <p class="muted" style="margin-top:12px">{{ disclaimer }}</p>
        {% endif %}
      </div>

      <div>
        {% if image_path %}
          <h3>ผลการทำนายล่าสุด</h3>
          <img src="{{ image_path }}" class="preview" alt="preview" />
          <p style="margin:10px 0 0">
            <strong>{{ prediction_label }}</strong>
            <span class="muted">(confidence {{ prediction_confidence }})</span>
          </p>

          <table>
            <thead><tr><th>Class</th><th>Probability</th></tr></thead>
            <tbody>
              {% for label, prob in prob_table %}
                <tr>
                  <td>{{ label }}</td>
                  <td style="width:60%">
                    <div class="prog"><span style="width: {{ (prob * 100)|round(1) }}%"></span></div>
                    <div class="muted">{{ '%.3f'|format(prob) }}</div>
                  </td>
                </tr>
              {% endfor %}
            </tbody>
          </table>
        {% else %}
          <p class="muted">อัปโหลดภาพเพื่อดูผลการทำนาย</p>
        {% endif %}
      </div>
    </div>

    <h2 class="section-title">ประวัติการทำนายล่าสุด</h2>
    {% if history and history|length > 0 %}
      <div class="gallery">
        {% for item in history %}
          <div class="thumb">
            <img src="{{ item.image_path }}" alt="{{ item.filename }}" />
            <div class="meta">
              <div><strong>{{ item.pred_label }}</strong> ({{ '%.3f'|format(item.pred_conf) }})</div>
              <div>{{ item.timestamp }}</div>
            </div>
          </div>
        {% endfor %}
      </div>
    {% else %}
      <p class="muted">ยังไม่มีประวัติ</p>
    {% endif %}
  </div>
</body>
</html>
